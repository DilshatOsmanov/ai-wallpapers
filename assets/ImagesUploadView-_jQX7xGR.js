import{h as z,r as U,o as n,c as o,a as t,F as m,b as w,w as j,u as D,d as N,e as V,f as x,g as p,i as M,v as C,n as S,t as c}from"./index-BtuXidbw.js";import{c as a,r as b,u as q}from"./index-TY88b9xx.js";import{S as G}from"./sweetalert2.esm.all-Br4OTrmy.js";const P=a.withParams({type:"numeric"},f=>{if(!f)return!0;const v=f.toString().replace(",","."),g=parseFloat(v);return!isNaN(g)&&g>0}),R=async f=>await z.post("/rooms/create_room",f,{headers:{"Content-Type":"multipart/form-data"}}),B=["disabled"],I=["src"],J=["onClick"],$={__name:"ImagesUpload",props:{files:Array,loading:Boolean},emits:["update:files"],setup(f,{emit:v}){const g=f,s=v,h=U([]),d=U(null),k=()=>{d.value.click()},F=u=>{const r=u.target.files;e(r)},i=u=>{if(g.loading)return;const r=u.dataTransfer.files;e(r)},e=u=>{for(let r of u){if(!["image/png","image/jpeg"].includes(r.type))continue;s("update:files",[...g.files,r]);const _=new FileReader;_.onload=y=>{h.value.push({url:y.target.result})},_.readAsDataURL(r)}},l=u=>{if(g.loading)return;h.value.splice(u,1);let r=[...g.files];r.splice(u,1),s("update:files",r)};return(u,r)=>(n(),o("div",{class:"col-12 image-upload-page__img-upload-form",onDragover:r[0]||(r[0]=j(()=>{},["prevent"])),onDrop:j(i,["prevent"]),style:{border:"2px dashed rgba(0, 0, 0, 0.7)",padding:"1rem"}},[t("div",{class:"cursor-pointer border rounded d-flex align-items-center justify-content-center image-upload-page__add-img-btn",onClick:k},[t("input",{type:"file",ref_key:"fileInput",ref:d,accept:"image/png, image/gif, image/jpeg",multiple:"",hidden:"",disabled:f.loading,onChange:F},null,40,B),r[1]||(r[1]=t("span",{class:"fs-1"},"+",-1))]),(n(!0),o(m,null,w(h.value,(_,y)=>(n(),o("div",{key:y,class:"position-relative"},[t("img",{src:_.url,class:"img-thumbnail"},null,8,I),t("button",{type:"button",class:"btn-close position-absolute top-0 end-0",onClick:ae=>l(y)},null,8,J)]))),128))],32))}},T={class:"bg-light p-3 p-md-4 p-xl-5 min-vh-100 d-flex flex-column justify-content-between",style:{"padding-top":"5rem !important"}},A={class:"container"},E={class:"row mb-4"},L={class:"row mb-4"},W={class:"row mb-4"},H={class:"row mb-4"},K={class:"container text-center"},O={class:"mb-3"},Q={class:"input-group"},X=["disabled"],Y={class:"mb-3"},Z={class:"input-group"},ee=["disabled"],te={class:"mb-3"},le={class:"input-group"},se=["disabled"],ie=["disabled"],de={__name:"ImagesUploadView",setup(f){const v=D(),g=N(),s=V({width:null,length:null,height:null,wall_files_1:[],wall_files_2:[],wall_files_3:[],wall_files_4:[],loading:!1}),h={width:{required:a.withMessage("Данное поле обязательно!",b),numeric:a.withMessage("Поле должно быть числовым!",P)},length:{required:a.withMessage("Данное поле обязательно!",b),numeric:a.withMessage("Поле должно быть числовым!",P)},height:{required:a.withMessage("Данное поле обязательно!",b),numeric:a.withMessage("Поле должно быть числовым!",P)},wall_files_1:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",b),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_2:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",b),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_3:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",b),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_4:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",b),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))}},d=q(h,s),k=async()=>{if(await d.value.$validate())try{s.loading=!0;const e=new FormData;e.append("width",s.width.toString().replace(",",".")),e.append("height",s.height.toString().replace(",",".")),e.append("length",s.length.toString().replace(",",".")),s.wall_files_1.forEach((l,u)=>{e.append("image_files",l)}),await R(e),g.push({name:"room-page"})}catch{G.fire({text:"Ошибка сервера!",icon:"error",showCancelButton:!1,showConfirmButton:!1})}finally{s.loading=!1}},F=()=>{v.dispatch("logout")};return(i,e)=>(n(),o(m,null,[t("nav",{class:"navbar navbar-default navbar-fixed-top"},[t("div",{class:"container"},[t("div",{class:"d-flex align-items-center justify-content-end w-100"},[t("div",{class:"dropdown"},[e[8]||(e[8]=t("button",{type:"button",class:"header__avatar","data-bs-toggle":"dropdown","aria-expanded":"false"}," JD ",-1)),t("ul",{class:"dropdown-menu dropdown-menu-dark dropdown-menu-end"},[e[7]||(e[7]=t("li",null,[t("a",{class:"dropdown-item",href:"#"},"Профиль")],-1)),t("li",null,[t("button",{class:"dropdown-item",type:"button",onClick:F},"Выйти")])])])])])]),t("section",T,[t("div",A,[e[13]||(e[13]=t("div",{class:"row mb-4"},[t("div",{class:"col-12 text-center"},[t("h1",{class:"image-upload-page__title fw-bold"}," Выберите картинки для генерации обоев для вашей комнаты с помощью ИИ "),t("p",{class:"image-upload-page__subtitle lead text-muted"}," Загрузите изображения, и наш искусственный интеллект поможет вам создать уникальные обои для вашего пространства. ")])],-1)),t("div",E,[e[9]||(e[9]=t("label",{for:"wall-1",class:"form-label text-start w-100"},"Стена №1",-1)),x($,{id:"wall-1",loading:s.loading,files:s.wall_files_1,"onUpdate:files":e[0]||(e[0]=l=>s.wall_files_1=l)},null,8,["loading","files"]),(n(!0),o(m,null,w(p(d).wall_files_1.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("div",L,[e[10]||(e[10]=t("label",{for:"wall-2",class:"form-label text-start w-100"},"Стена №2",-1)),x($,{id:"wall-2",loading:s.loading,files:s.wall_files_2,"onUpdate:files":e[1]||(e[1]=l=>s.wall_files_2=l)},null,8,["loading","files"]),(n(!0),o(m,null,w(p(d).wall_files_2.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("div",W,[e[11]||(e[11]=t("label",{for:"wall-3",class:"form-label text-start w-100"},"Стена №3",-1)),x($,{id:"wall-3",loading:s.loading,files:s.wall_files_3,"onUpdate:files":e[2]||(e[2]=l=>s.wall_files_3=l)},null,8,["loading","files"]),(n(!0),o(m,null,w(p(d).wall_files_3.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("div",H,[e[12]||(e[12]=t("label",{for:"wall-4",class:"form-label text-start w-100"},"Стена №4",-1)),x($,{id:"wall-4",loading:s.loading,files:s.wall_files_4,"onUpdate:files":e[3]||(e[3]=l=>s.wall_files_4=l)},null,8,["loading","files"]),(n(!0),o(m,null,w(p(d).wall_files_4.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))])]),t("div",K,[t("div",O,[e[15]||(e[15]=t("label",{for:"input-room-length",class:"form-label text-start w-100"},"Длина комнаты",-1)),t("div",Q,[M(t("input",{id:"input-room-length",type:"text","aria-label":"Room length","aria-describedby":"length-addon",inputmode:"decimal",class:S(["form-control",{"is-invalid":p(d).length.$errors.length}]),disabled:s.loading,"onUpdate:modelValue":e[4]||(e[4]=l=>s.length=l)},null,10,X),[[C,s.length]]),e[14]||(e[14]=t("div",{class:"input-group-append"},[t("span",{class:"input-group-text",id:"length-addon"},"м")],-1))]),(n(!0),o(m,null,w(p(d).length.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("div",Y,[e[17]||(e[17]=t("label",{for:"input-room-width",class:"form-label text-start w-100"},"Ширина комнаты",-1)),t("div",Z,[M(t("input",{id:"input-room-width",type:"text","aria-label":"Room width","aria-describedby":"width-addon",inputmode:"decimal",class:S(["form-control",{"is-invalid":p(d).width.$errors.length}]),disabled:s.loading,"onUpdate:modelValue":e[5]||(e[5]=l=>s.width=l)},null,10,ee),[[C,s.width]]),e[16]||(e[16]=t("div",{class:"input-group-append"},[t("span",{class:"input-group-text",id:"width-addo2"},"м")],-1))]),(n(!0),o(m,null,w(p(d).width.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("div",te,[e[19]||(e[19]=t("label",{for:"input-room-height",class:"form-label text-start w-100"},"Высота комнаты",-1)),t("div",le,[M(t("input",{id:"input-room-height",type:"text","aria-label":"Room height","aria-describedby":"height-addon",inputmode:"decimal",class:S(["form-control",{"is-invalid":p(d).height.$errors.length}]),disabled:s.loading,"onUpdate:modelValue":e[6]||(e[6]=l=>s.height=l)},null,10,se),[[C,s.height]]),e[18]||(e[18]=t("div",{class:"input-group-append"},[t("span",{class:"input-group-text",id:"height-addon"},"м")],-1))]),(n(!0),o(m,null,w(p(d).height.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},c(l.$message),1))),128))]),t("button",{type:"button",class:"btn btn-primary btn-lg px-5",disabled:s.loading,onClick:k},c(s.loading?"Загрузка...":"Генерировать"),9,ie)])])],64))}};export{de as default};
