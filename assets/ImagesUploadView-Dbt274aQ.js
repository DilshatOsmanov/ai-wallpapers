import{h as z,d as P,o as n,c as o,a as s,F as f,e as c,w as U,f as N,g as V,b as x,i as u,j as F,v as M,n as C,t as m}from"./index-NywCWorg.js";import{c as a,r as w,u as q}from"./index-CX8pzUCW.js";import{S as D}from"./sweetalert2.esm.all-Br4OTrmy.js";const S=a.withParams({type:"numeric"},p=>{if(!p)return!0;const h=p.toString().replace(",","."),t=parseFloat(h);return!isNaN(t)&&t>0}),G=async p=>await z.post("/rooms/create_room",p,{headers:{"Content-Type":"multipart/form-data"}}),R=["disabled"],B=["src"],I=["onClick"],$={__name:"ImagesUpload",props:{files:Array,loading:Boolean},emits:["update:files"],setup(p,{emit:h}){const t=p,b=h,r=P([]),v=P(null),i=()=>{v.value.click()},e=g=>{const d=g.target.files;k(d)},l=g=>{if(t.loading)return;const d=g.dataTransfer.files;k(d)},k=g=>{for(let d of g){if(!["image/png","image/jpeg"].includes(d.type))continue;b("update:files",[...t.files,d]);const _=new FileReader;_.onload=y=>{r.value.push({url:y.target.result})},_.readAsDataURL(d)}},j=g=>{if(t.loading)return;r.value.splice(g,1);let d=[...t.files];d.splice(g,1),b("update:files",d)};return(g,d)=>(n(),o("div",{class:"col-12 image-upload-page__img-upload-form",onDragover:d[0]||(d[0]=U(()=>{},["prevent"])),onDrop:U(l,["prevent"]),style:{border:"2px dashed rgba(0, 0, 0, 0.7)",padding:"1rem"}},[s("div",{class:"cursor-pointer border rounded d-flex align-items-center justify-content-center image-upload-page__add-img-btn",onClick:i},[s("input",{type:"file",ref_key:"fileInput",ref:v,accept:"image/png, image/gif, image/jpeg",multiple:"",hidden:"",disabled:p.loading,onChange:e},null,40,R),d[1]||(d[1]=s("span",{class:"fs-1"},"+",-1))]),(n(!0),o(f,null,c(r.value,(_,y)=>(n(),o("div",{key:y,class:"position-relative"},[s("img",{src:_.url,class:"img-thumbnail"},null,8,B),s("button",{type:"button",class:"btn-close position-absolute top-0 end-0",onClick:ie=>j(y)},null,8,I)]))),128))],32))}},J={class:"bg-light p-3 p-md-4 p-xl-5 min-vh-100 d-flex flex-column justify-content-between",style:{"padding-top":"5rem !important"}},T={class:"container"},A={class:"row mb-4"},E={class:"row mb-4"},L={class:"row mb-4"},W={class:"row mb-4"},H={class:"container text-center"},K={class:"mb-3"},O={class:"input-group"},Q=["disabled"],X={class:"mb-3"},Y={class:"input-group"},Z=["disabled"],ee={class:"mb-3"},te={class:"input-group"},le=["disabled"],se=["disabled"],re={__name:"ImagesUploadView",setup(p){const h=N(),t=V({width:null,length:null,height:null,wall_files_1:[],wall_files_2:[],wall_files_3:[],wall_files_4:[],loading:!1}),b={width:{required:a.withMessage("Данное поле обязательно!",w),numeric:a.withMessage("Поле должно быть числовым!",S)},length:{required:a.withMessage("Данное поле обязательно!",w),numeric:a.withMessage("Поле должно быть числовым!",S)},height:{required:a.withMessage("Данное поле обязательно!",w),numeric:a.withMessage("Поле должно быть числовым!",S)},wall_files_1:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",w),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_2:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",w),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_3:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",w),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))},wall_files_4:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",w),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",i=>i.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",i=>i.every(e=>e.size<=5*1024*1024))}},r=q(b,t),v=async()=>{if(await r.value.$validate())try{t.loading=!0;const e=new FormData;e.append("width",t.width.toString().replace(",",".")),e.append("height",t.height.toString().replace(",",".")),e.append("length",t.length.toString().replace(",",".")),t.wall_files_1.forEach((l,k)=>{e.append("image_files",l)}),await G(e),h.push({name:"room-page"})}catch{D.fire({text:"Ошибка сервера!",icon:"error",showCancelButton:!1,showConfirmButton:!1})}finally{t.loading=!1}};return(i,e)=>(n(),o("section",J,[s("div",T,[e[11]||(e[11]=s("div",{class:"row mb-4"},[s("div",{class:"col-12 text-center"},[s("h1",{class:"image-upload-page__title fw-bold"}," Выберите картинки для генерации обоев для вашей комнаты с помощью ИИ "),s("p",{class:"image-upload-page__subtitle lead text-muted"}," Загрузите изображения, и наш искусственный интеллект поможет вам создать уникальные обои для вашего пространства. ")])],-1)),s("div",A,[e[7]||(e[7]=s("label",{for:"wall-1",class:"form-label text-start w-100"},"Стена №1",-1)),x($,{id:"wall-1",loading:t.loading,files:t.wall_files_1,"onUpdate:files":e[0]||(e[0]=l=>t.wall_files_1=l)},null,8,["loading","files"]),(n(!0),o(f,null,c(u(r).wall_files_1.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("div",E,[e[8]||(e[8]=s("label",{for:"wall-2",class:"form-label text-start w-100"},"Стена №2",-1)),x($,{id:"wall-2",loading:t.loading,files:t.wall_files_2,"onUpdate:files":e[1]||(e[1]=l=>t.wall_files_2=l)},null,8,["loading","files"]),(n(!0),o(f,null,c(u(r).wall_files_2.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("div",L,[e[9]||(e[9]=s("label",{for:"wall-3",class:"form-label text-start w-100"},"Стена №3",-1)),x($,{id:"wall-3",loading:t.loading,files:t.wall_files_3,"onUpdate:files":e[2]||(e[2]=l=>t.wall_files_3=l)},null,8,["loading","files"]),(n(!0),o(f,null,c(u(r).wall_files_3.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("div",W,[e[10]||(e[10]=s("label",{for:"wall-4",class:"form-label text-start w-100"},"Стена №4",-1)),x($,{id:"wall-4",loading:t.loading,files:t.wall_files_4,"onUpdate:files":e[3]||(e[3]=l=>t.wall_files_4=l)},null,8,["loading","files"]),(n(!0),o(f,null,c(u(r).wall_files_4.$errors,l=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))])]),s("div",H,[s("div",K,[e[13]||(e[13]=s("label",{for:"input-room-length",class:"form-label text-start w-100"},"Длина комнаты",-1)),s("div",O,[F(s("input",{id:"input-room-length",type:"text","aria-label":"Room length","aria-describedby":"length-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).length.$errors.length}]),disabled:t.loading,"onUpdate:modelValue":e[4]||(e[4]=l=>t.length=l)},null,10,Q),[[M,t.length]]),e[12]||(e[12]=s("div",{class:"input-group-append"},[s("span",{class:"input-group-text",id:"length-addon"},"м")],-1))]),(n(!0),o(f,null,c(u(r).length.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("div",X,[e[15]||(e[15]=s("label",{for:"input-room-width",class:"form-label text-start w-100"},"Ширина комнаты",-1)),s("div",Y,[F(s("input",{id:"input-room-width",type:"text","aria-label":"Room width","aria-describedby":"width-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).width.$errors.length}]),disabled:t.loading,"onUpdate:modelValue":e[5]||(e[5]=l=>t.width=l)},null,10,Z),[[M,t.width]]),e[14]||(e[14]=s("div",{class:"input-group-append"},[s("span",{class:"input-group-text",id:"width-addo2"},"м")],-1))]),(n(!0),o(f,null,c(u(r).width.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("div",ee,[e[17]||(e[17]=s("label",{for:"input-room-height",class:"form-label text-start w-100"},"Высота комнаты",-1)),s("div",te,[F(s("input",{id:"input-room-height",type:"text","aria-label":"Room height","aria-describedby":"height-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).height.$errors.length}]),disabled:t.loading,"onUpdate:modelValue":e[6]||(e[6]=l=>t.height=l)},null,10,le),[[M,t.height]]),e[16]||(e[16]=s("div",{class:"input-group-append"},[s("span",{class:"input-group-text",id:"height-addon"},"м")],-1))]),(n(!0),o(f,null,c(u(r).height.$errors,l=>(n(),o("div",{class:"invalid-feedback text-start",key:l.$uid},m(l.$message),1))),128))]),s("button",{type:"button",class:"btn btn-primary btn-lg px-5",disabled:t.loading,onClick:v},m(t.loading?"Загрузка...":"Генерировать"),9,se)])]))}};export{re as default};
