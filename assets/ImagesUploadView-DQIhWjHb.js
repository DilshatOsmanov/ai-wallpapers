import{d as P,o as n,c as o,a as i,F as m,e as f,w as U,f as N,g as V,b as x,h as u,i as F,v as M,n as C,t as p}from"./index-D2gw8f21.js";import{c as a,r as c,u as j}from"./index-Bpmr0gwN.js";import{S as q}from"./sweetalert2.esm.all-Br4OTrmy.js";import{c as D}from"./room-D1GQVSsA.js";const S=a.withParams({type:"numeric"},w=>{if(!w)return!0;const h=w.toString().replace(",","."),l=parseFloat(h);return!isNaN(l)&&l>0}),G=["disabled"],R=["src"],B=["onClick"],$={__name:"ImagesUpload",props:{files:Array,loading:Boolean},emits:["update:files"],setup(w,{emit:h}){const l=w,b=h,r=P([]),v=P(null),s=()=>{v.value.click()},e=g=>{const d=g.target.files;k(d)},t=g=>{if(l.loading)return;const d=g.dataTransfer.files;k(d)},k=g=>{for(let d of g){if(!["image/png","image/jpeg"].includes(d.type))continue;b("update:files",[...l.files,d]);const _=new FileReader;_.onload=y=>{r.value.push({url:y.target.result})},_.readAsDataURL(d)}},z=g=>{if(l.loading)return;r.value.splice(g,1);let d=[...l.files];d.splice(g,1),b("update:files",d)};return(g,d)=>(n(),o("div",{class:"col-12 image-upload-page__img-upload-form",onDragover:d[0]||(d[0]=U(()=>{},["prevent"])),onDrop:U(t,["prevent"]),style:{border:"2px dashed rgba(0, 0, 0, 0.7)",padding:"1rem"}},[i("div",{class:"cursor-pointer border rounded d-flex align-items-center justify-content-center image-upload-page__add-img-btn",onClick:s},[i("input",{type:"file",ref_key:"fileInput",ref:v,accept:"image/png, image/gif, image/jpeg",multiple:"",hidden:"",disabled:w.loading,onChange:e},null,40,G),d[1]||(d[1]=i("span",{class:"fs-1"},"+",-1))]),(n(!0),o(m,null,f(r.value,(_,y)=>(n(),o("div",{key:y,class:"position-relative"},[i("img",{src:_.url,class:"img-thumbnail"},null,8,R),i("button",{type:"button",class:"btn-close position-absolute top-0 end-0",onClick:ie=>z(y)},null,8,B)]))),128))],32))}},I={class:"bg-light p-3 p-md-4 p-xl-5 d-flex flex-column justify-content-between",style:{"padding-top":"5rem !important"}},J={class:"container"},A={class:"row mb-4"},E={class:"row mb-4"},L={class:"row mb-4"},T={class:"row mb-4"},W={class:"text-center"},H={class:"mb-3"},K={class:"input-group"},O=["disabled"],Q={class:"mb-3"},X={class:"input-group"},Y=["disabled"],Z={class:"mb-3"},ee={class:"input-group"},le=["disabled"],te=["disabled"],re={__name:"ImagesUploadView",setup(w){const h=N(),l=V({width:null,length:null,height:null,wall_files_1:[],wall_files_2:[],wall_files_3:[],wall_files_4:[],loading:!1}),b={width:{required:a.withMessage("Данное поле обязательно!",c),numeric:a.withMessage("Поле должно быть числовым!",S)},length:{required:a.withMessage("Данное поле обязательно!",c),numeric:a.withMessage("Поле должно быть числовым!",S)},height:{required:a.withMessage("Данное поле обязательно!",c),numeric:a.withMessage("Поле должно быть числовым!",S)},wall_files_1:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",c),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",s=>s.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",s=>s.every(e=>e.size<=5*1024*1024))},wall_files_2:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",c),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",s=>s.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",s=>s.every(e=>e.size<=5*1024*1024))},wall_files_3:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",c),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",s=>s.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",s=>s.every(e=>e.size<=5*1024*1024))},wall_files_4:{required:a.withMessage("Необходимо загрузить хотя бы одно изображение!",c),validFileFormat:a.withMessage("Формат файла должен быть PNG или JPG!",s=>s.every(e=>["image/png","image/jpeg"].includes(e.type))),validFileSize:a.withMessage("Размер файла не должен превышать 5МБ!",s=>s.every(e=>e.size<=5*1024*1024))}},r=j(b,l),v=async()=>{if(await r.value.$validate())try{l.loading=!0;const e=new FormData;e.append("width",l.width.toString().replace(",",".")),e.append("height",l.height.toString().replace(",",".")),e.append("length",l.length.toString().replace(",",".")),l.wall_files_1.forEach((t,k)=>{e.append("image_files",t)}),await D(e),h.push({name:"room-page"})}catch{q.fire({text:"Ошибка сервера!",icon:"error",showCancelButton:!1,showConfirmButton:!1})}finally{l.loading=!1}};return(s,e)=>(n(),o("section",I,[i("div",J,[e[17]||(e[17]=i("div",{class:"row mb-4"},[i("div",{class:"col-12 text-center"},[i("h1",{class:"image-upload-page__title fw-bold"}," Выберите картинки для генерации обоев для вашей комнаты с помощью ИИ "),i("p",{class:"image-upload-page__subtitle lead text-muted"}," Загрузите изображения, и наш искусственный интеллект поможет вам создать уникальные обои для вашего пространства. ")])],-1)),i("div",A,[e[7]||(e[7]=i("label",{for:"wall-1",class:"form-label text-start w-100"},"Стена №1",-1)),x($,{id:"wall-1",loading:l.loading,files:l.wall_files_1,"onUpdate:files":e[0]||(e[0]=t=>l.wall_files_1=t)},null,8,["loading","files"]),(n(!0),o(m,null,f(u(r).wall_files_1.$errors,t=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",E,[e[8]||(e[8]=i("label",{for:"wall-2",class:"form-label text-start w-100"},"Стена №2",-1)),x($,{id:"wall-2",loading:l.loading,files:l.wall_files_2,"onUpdate:files":e[1]||(e[1]=t=>l.wall_files_2=t)},null,8,["loading","files"]),(n(!0),o(m,null,f(u(r).wall_files_2.$errors,t=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",L,[e[9]||(e[9]=i("label",{for:"wall-3",class:"form-label text-start w-100"},"Стена №3",-1)),x($,{id:"wall-3",loading:l.loading,files:l.wall_files_3,"onUpdate:files":e[2]||(e[2]=t=>l.wall_files_3=t)},null,8,["loading","files"]),(n(!0),o(m,null,f(u(r).wall_files_3.$errors,t=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",T,[e[10]||(e[10]=i("label",{for:"wall-4",class:"form-label text-start w-100"},"Стена №4",-1)),x($,{id:"wall-4",loading:l.loading,files:l.wall_files_4,"onUpdate:files":e[3]||(e[3]=t=>l.wall_files_4=t)},null,8,["loading","files"]),(n(!0),o(m,null,f(u(r).wall_files_4.$errors,t=>(n(),o("div",{class:"d-block invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",W,[i("div",H,[e[12]||(e[12]=i("label",{for:"input-room-length",class:"form-label text-start w-100"},"Длина комнаты",-1)),i("div",K,[F(i("input",{id:"input-room-length",type:"text","aria-label":"Room length","aria-describedby":"length-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).length.$errors.length}]),disabled:l.loading,"onUpdate:modelValue":e[4]||(e[4]=t=>l.length=t)},null,10,O),[[M,l.length]]),e[11]||(e[11]=i("div",{class:"input-group-append"},[i("span",{class:"input-group-text",id:"length-addon"},"м")],-1))]),(n(!0),o(m,null,f(u(r).length.$errors,t=>(n(),o("div",{class:"invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",Q,[e[14]||(e[14]=i("label",{for:"input-room-width",class:"form-label text-start w-100"},"Ширина комнаты",-1)),i("div",X,[F(i("input",{id:"input-room-width",type:"text","aria-label":"Room width","aria-describedby":"width-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).width.$errors.length}]),disabled:l.loading,"onUpdate:modelValue":e[5]||(e[5]=t=>l.width=t)},null,10,Y),[[M,l.width]]),e[13]||(e[13]=i("div",{class:"input-group-append"},[i("span",{class:"input-group-text",id:"width-addo2"},"м")],-1))]),(n(!0),o(m,null,f(u(r).width.$errors,t=>(n(),o("div",{class:"invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("div",Z,[e[16]||(e[16]=i("label",{for:"input-room-height",class:"form-label text-start w-100"},"Высота комнаты",-1)),i("div",ee,[F(i("input",{id:"input-room-height",type:"text","aria-label":"Room height","aria-describedby":"height-addon",inputmode:"decimal",class:C(["form-control",{"is-invalid":u(r).height.$errors.length}]),disabled:l.loading,"onUpdate:modelValue":e[6]||(e[6]=t=>l.height=t)},null,10,le),[[M,l.height]]),e[15]||(e[15]=i("div",{class:"input-group-append"},[i("span",{class:"input-group-text",id:"height-addon"},"м")],-1))]),(n(!0),o(m,null,f(u(r).height.$errors,t=>(n(),o("div",{class:"invalid-feedback text-start",key:t.$uid},p(t.$message),1))),128))]),i("button",{type:"button",class:"btn btn-primary btn-lg px-5",disabled:l.loading,onClick:v},p(l.loading?"Загрузка...":"Генерировать"),9,te)])])]))}};export{re as default};
